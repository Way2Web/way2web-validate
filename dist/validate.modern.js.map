{"version":3,"file":"validate.modern.js","sources":["../js/validate.js"],"sourcesContent":["/**\n * Validate forms with ajax.\n */\nclass Way2Validate {\n    /**\n     * Constructor.\n     *\n     * @param {object} $element\n     */\n    constructor($element) {\n        /** @type {string} */\n        this.version = '2.0.0';\n\n        /**\n         * Global variables.\n         *\n         * @type {Object}\n         */\n        this.globals = {\n            errors:     {},\n            formGroups: []\n        };\n\n        /**\n         * Selectors.\n         *\n         * @type {Object}\n         */\n        this.selectors = {\n            group: '.form-group',\n            input: '.form-control'\n        };\n\n        /**\n         * Attributes.\n         *\n         * @type {Object}\n         */\n        this.attributes = {\n            url:    'validate-url',\n            method: 'method'\n        };\n\n        /**\n         * Classes.\n         *\n         * @type {Object}\n         */\n        this.classes = {\n            error: 'has-error',\n            help:  'help-block'\n        };\n\n        this.element = $element;\n        this.element.on('submit', this.send.bind(this));\n    }\n\n    /**\n     * Submit the form.\n     *\n     * @param {object} event\n     */\n    send(event) {\n        this.element = $(event.target);\n        let url = this.element.data(this.attributes.url);\n        let method = this.element.attr(this.attributes.method);\n        let data = this.element.serialize();\n\n        if(!url || !method) {\n            this.error();\n\n            return;\n        }\n\n        axios({\n            method:         method,\n            url:            url,\n            data:           data,\n            validateStatus: (status) => {\n                return status < 500;\n            }\n        })\n            .then(this.success.bind(this))\n            .catch(this.error.bind(this));\n\n        event.preventDefault();\n    }\n\n    /**\n     * Handles a successful validation.\n     *\n     * @param {object} data\n     */\n    success(data) {\n        let formGroups = this.element.find(this.selectors.group);\n\n        if(data.status == 200) {\n            this.globals.errors = {};\n\n            this.element.unbind('submit').submit();\n        } else {\n            formGroups.removeClass(this.classes.error);\n            formGroups.find('.' + this.classes.help).remove();\n\n            this.globals.errors = data.data.errors;\n\n            $.each(data.data.errors, this.showErrors.bind(this));\n        }\n    }\n\n    /**\n     * Show the errors.\n     *\n     * @param {string} field\n     * @param {array}  errors\n     */\n    showErrors(field, errors) {\n        let formGroup = this.element\n            .find(\n                this.selectors.input + '[name=\"' + field + '\"], ' +\n                this.selectors.input + '[name=\"' + field + '[]\"]'\n            )\n            .closest(this.selectors.group);\n\n        formGroup.addClass(this.classes.error);\n        formGroup.append('<span class=\"' + this.classes.help + '\"><strong>' + errors.join(', ') + '</strong></span>');\n    }\n\n    /**\n     * Handles a validation error.\n     *\n     * @param {object} error\n     */\n    error(error) {\n        console.error('error', error);\n    }\n}\n\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = Way2Validate;\n}\n"],"names":["module","exports","constructor","$element","this","version","globals","errors","formGroups","selectors","group","input","attributes","url","method","classes","error","help","element","on","send","bind","event","$","target","data","attr","serialize","axios","validateStatus","status","then","success","catch","preventDefault","find","unbind","submit","removeClass","remove","each","showErrors","field","formGroup","closest","addClass","append","join","console"],"mappings":"AA0IsB,oBAAXA,QAA0BA,OAAOC,UACxCD,OAAOC,QAxIX,MAMIC,YAAYC,GAERC,KAAKC,QAAU,QAOfD,KAAKE,QAAU,CACXC,OAAY,GACZC,WAAY,IAQhBJ,KAAKK,UAAY,CACbC,MAAO,cACPC,MAAO,iBAQXP,KAAKQ,WAAa,CACdC,IAAQ,eACRC,OAAQ,UAQZV,KAAKW,QAAU,CACXC,MAAO,YACPC,KAAO,cAGXb,KAAKc,QAAUf,EACfC,KAAKc,QAAQC,GAAG,SAAUf,KAAKgB,KAAKC,KAAKjB,OAQ7CgB,KAAKE,GACDlB,KAAKc,QAAUK,EAAED,EAAME,QACvB,IAAIX,EAAMT,KAAKc,QAAQO,KAAKrB,KAAKQ,WAAWC,KACxCC,EAASV,KAAKc,QAAQQ,KAAKtB,KAAKQ,WAAWE,QAC3CW,EAAOrB,KAAKc,QAAQS,YAEpBd,GAAQC,GAMZc,MAAM,CACFd,OAAgBA,EAChBD,IAAgBA,EAChBY,KAAgBA,EAChBI,eAAiBC,GACNA,EAAS,MAGnBC,KAAK3B,KAAK4B,QAAQX,KAAKjB,OACvB6B,MAAM7B,KAAKY,MAAMK,KAAKjB,OAE3BkB,EAAMY,kBAhBF9B,KAAKY,QAwBbgB,QAAQP,GACJ,IAAIjB,EAAaJ,KAAKc,QAAQiB,KAAK/B,KAAKK,UAAUC,OAEhC,KAAfe,EAAKK,QACJ1B,KAAKE,QAAQC,OAAS,GAEtBH,KAAKc,QAAQkB,OAAO,UAAUC,WAE9B7B,EAAW8B,YAAYlC,KAAKW,QAAQC,OACpCR,EAAW2B,KAAK,IAAM/B,KAAKW,QAAQE,MAAMsB,SAEzCnC,KAAKE,QAAQC,OAASkB,EAAKA,KAAKlB,OAEhCgB,EAAEiB,KAAKf,EAAKA,KAAKlB,OAAQH,KAAKqC,WAAWpB,KAAKjB,QAUtDqC,WAAWC,EAAOnC,GACd,IAAIoC,EAAYvC,KAAKc,QAChBiB,KACG/B,KAAKK,UAAUE,MAAQ,UAAY+B,EAAQ,OAC3CtC,KAAKK,UAAUE,MAAQ,UAAY+B,EAAQ,QAE9CE,QAAQxC,KAAKK,UAAUC,OAE5BiC,EAAUE,SAASzC,KAAKW,QAAQC,OAChC2B,EAAUG,OAAO,gBAAkB1C,KAAKW,QAAQE,KAAO,aAAeV,EAAOwC,KAAK,MAAQ,oBAQ9F/B,MAAMA,GACFgC,QAAQhC,MAAM,QAASA"}